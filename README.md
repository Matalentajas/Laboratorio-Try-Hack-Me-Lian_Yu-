## üèùÔ∏è Lian\_Yu (TryHackMe) - Write-up

Este repositorio contiene la documentaci√≥n completa y detallada (write-up) del desaf√≠o de ciberseguridad **Lian\_Yu** de TryHackMe.

La m√°quina, de dificultad f√°cil, est√° fuertemente tematizada en la serie *Arrow* de DC Comics (Oliver Queen, Slade Wilson/Deathstroke), y pone a prueba habilidades fundamentales de un pentester.

**Metodolog√≠a y T√©cnicas Demostradas:**

* **Enumeraci√≥n:** Nmap, Gobuster, CeWL.
* **Acceso Inicial:** Descubrimiento y decodificaci√≥n de tokens (**Base58**) y credenciales.
* **An√°lisis Forense:** Extracci√≥n de datos ocultos mediante **Esteganograf√≠a (StegSeek)** en archivos de imagen.
* **Pivotaje:** Obtenci√≥n de credenciales de un segundo usuario.
* **Escalada de Privilegios:** Identificaci√≥n y explotaci√≥n de binarios **SUID (`pkexec`)** utilizando recursos como **GTFOBins**.

---
**¬°Misi√≥n cumplida: Acceso total como Root!**

üèπ Laboratorio: Compromiso Total de "Lian_Yu" (TryHackMe - ID [Room ID])Este documento detalla el an√°lisis de vulnerabilidades y el proceso de Penetration Test (Pentest) realizado sobre la m√°quina objetivo 10.10.46.117. El ejercicio culmin√≥ con √©xito, logrando el acceso root y la obtenci√≥n de las flags de usuario y administrador.1. üìå Resumen EjecutivoEl objetivo fue comprometido debido a una secuencia de pistas tem√°ticas (vigilante) y fallos cr√≠ticos en la gesti√≥n de esteganograf√≠a que llevaron a la escalada de privilegios SUID.Estado del ObjetivoTipo de CompromisoVulnerabilidad Cr√≠ticaImpactoCOMPROMETIDOControl Total (Root)Mala Configuraci√≥n de SUID (pkexec)CR√çTICOBanderas Obtenidas:User Flag: THM{P3O P7E_K33P_53CR3T5_C0MPUT3R5_D0N'T}Root Flag: THM{MY_WORD_IS_MY_B0ND_IF_I_ACC3PT_YOUR_CONTRACT_THEN_IT_WILL_BE_C0MPL3T3D_OR_I'LL_BE_D34D}2. üõ°Ô∏è Metodolog√≠a de Ataque (PTES/OSSTMM)El ataque se ejecut√≥ siguiendo una metodolog√≠a estructurada, donde cada pista tem√°tica (Arrow/Deathstroke) se convirti√≥ en un componente cr√≠tico para el avance.Fase A: Reconocimiento y Obtenci√≥n de AccesoPasoTarea ClaveHerramientaResultado y Pista1.Escaneo de ServiciosNmapPuertos 21 (FTP), 22 (SSH) y 80 (HTTP) abiertos.2.Enumeraci√≥n WebGobusterDirectorios /island/ y /island/2100m/ encontrados.3.Descubrimiento Credencialescurl / Base58Token RTy8yhB0dscX decodificado a !#th3h00d.4.Acceso InicialFTPAcceso como usuario vigilante:!#th3h00d.5.Pista de Esteganograf√≠aStegSeekArchivo aa.jpg conten√≠a un ZIP con contrase√±a password.6.Obtenci√≥n de Credencialunzip / cat shadoCredencial para el usuario slade:M3tahuman.Fase B: Post-Explotaci√≥n y Escalada de PrivilegiosPasoTarea ClaveHerramientaResultado y Vector7.Acceso de UsuariosshAcceso como usuario slade y obtenci√≥n de user.txt.8.Detecci√≥n de Vectorfind / -perm -u=sIdentificaci√≥n del binario cr√≠tico: /usr/bin/pkexec con el bit SUID.9.Referencia de ExploitGTFOBinsConfirmaci√≥n del m√©todo de explotaci√≥n para pkexec SUID.10.Escalada de Privilegiossudo pkexecObtenci√≥n de una shell de root (#) tras autenticaci√≥n.11.Impacto Finalcat root.txtLectura de la root flag, confirmando el compromiso total.3. üö® An√°lisis de Vulnerabilidades Encontradas3.1. Vulnerabilidad Cr√≠tica: Binario SUID Inseguro (pkexec)Vector: Escalada de Privilegios.Descripci√≥n: El binario /usr/bin/pkexec (PolicyKit) estaba configurado con el bit SUID. Aunque la explotaci√≥n directa de la vulnerabilidad "Pwnkit" no se confirm√≥, el binario permiti√≥ la ejecuci√≥n de una shell con privilegios de root despu√©s de una simple autenticaci√≥n con la contrase√±a del usuario slade, lo que indica una configuraci√≥n extremadamente laxa o un exploit funcional en el entorno de ejecuci√≥n.Bash# Comando de Explotaci√≥n (Referencia GTFOBins - SUID):
sudo pkexec /bin/sh
3.2. Vulnerabilidad Alta: Uso de Esteganograf√≠a y Contrase√±as D√©bilesVector: Acceso Inicial.Descripci√≥n: El sistema depend√≠a de m√©todos de esteganograf√≠a con contrase√±as extremadamente d√©biles (password), permitiendo al atacante descubrir las credenciales del usuario slade (M3tahuman) a trav√©s de la fuerza bruta autom√°tica (stegseek). Adem√°s, la contrase√±a inicial (!#th3h00d) era vulnerable a la decodificaci√≥n trivial (Base58) y el ataque de fuerza bruta.4. üìù Recomendaciones de Seguridad (Mitigaci√≥n)Para evitar la repetici√≥n de este compromiso, se recomienda lo siguiente:Gesti√≥n de Privilegios (SUID):Eliminar el bit SUID de binarios que no lo requieran estrictamente para su funcionamiento (pkexec, etc.).Actualizar el sistema operativo para aplicar parches contra vulnerabilidades SUID cr√≠ticas como "Pwnkit" que afectan a pkexec.Seguridad de Archivos y Datos Ocultos:Nunca utilizar contrase√±as d√©biles o de diccionario (password) para proteger archivos o datos esteganogr√°ficos.Evitar almacenar pistas de acceso (como .other_user o archivos con extensiones no est√°ndar) en directorios accesibles a usuarios de bajo privilegio.Pol√≠tica de Credenciales:Implementar una pol√≠tica de contrase√±as robusta.Deshabilitar el acceso FTP o restringirlo a usuarios y directorios espec√≠ficos.5. üíª Ap√©ndice B: Registro Detallado de Comandos#FaseProp√≥sitoComando Ejecutado1ReconocimientoEscaneo de servicios.nmap -sC -sV 10.10.46.1172Enumeraci√≥n WebDescubrir ruta.gobuster dir -u http://10.10.46.117/ -w [wordlist]...3Enumeraci√≥n WebVer contenido y token.curl http://10.10.46.117/island/4DescubrimientoDecodificar Base58 y usar FTP.ftp vigilante@10.10.46.1175Post-Explotaci√≥nDescargar archivos cr√≠ticos.ftp> get .other_user, get aa.jpg6Post-Explotaci√≥nForzar esteganograf√≠a.stegseek aa.jpg7Post-Explotaci√≥nObtener credencial.unzip aa.jpg.out y cat shado8Control UsuarioConexi√≥n y user.txt.ssh slade@10.10.46.117 seguido de cat user.txt9EscaladaBuscar binarios SUID.find / -perm -u=s -type f 2>/dev/null10Control TotalEjecutar el Exploit.sudo pkexec /bin/sh11Control TotalObtenci√≥n de root.txt.cat /root/root.txt
